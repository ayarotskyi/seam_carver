TODO:

1. optimize carving, energy matrix recomputation, horizontal extraction (maybe vertical too)
